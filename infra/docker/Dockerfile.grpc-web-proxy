FROM golang:1.21-alpine AS builder

RUN apk add --no-cache git
RUN go install github.com/improbable-eng/grpc-web/go/grpcwebproxy@latest

FROM alpine:latest
RUN apk --no-cache add ca-certificates
COPY --from=builder /go/bin/grpcwebproxy /usr/local/bin/grpcwebproxy

EXPOSE 8080

CMD ["grpcwebproxy", "--backend_addr=coordinator:50051", "--backend_tls=false", "--run_tls_server=false", "--allow_all_origins", "--server_http_debug_port=8080"]

